<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–Ø–ø–æ–Ω–∏—è 2026: Mobile App Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,700;1,400&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans', sans-serif;
            background-color: #fcfbf9;
            color: #292524;
            -webkit-tap-highlight-color: transparent; /* Remove tap highlight on mobile */
        }
        
        h1, h2, h3, .serif-font {
            font-family: 'Merriweather', serif;
        }

        /* Utils */
        .hide-scroll::-webkit-scrollbar { display: none; }
        .hide-scroll { -ms-overflow-style: none; scrollbar-width: none; }

        /* Badge Styles */
        .food-badge {
            display: inline-flex;
            align-items: center;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .badge-history { background: #fff1f2; color: #9f1239; border: 1px solid #fecdd3; }
        .badge-local { background: #f0fdf4; color: #15803d; border: 1px solid #bbf7d0; }
        .badge-sweet { background: #fff7ed; color: #c2410c; border: 1px solid #fed7aa; }
        .badge-tech { background: #eff6ff; color: #1d4ed8; border: 1px solid #bfdbfe; }

        /* Mobile specific adjustments */
        .mobile-safe-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        .fade-in { animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .anthro-note {
            border-left: 3px solid #d6d3d1;
            padding-left: 12px;
            font-style: italic;
            color: #57534e;
            font-size: 0.85rem;
            margin-top: 8px;
        }
    </style>
</head>
<body class="antialiased flex flex-col min-h-screen pb-20 md:pb-0">

    <!-- Header (Compact on Mobile) -->
    <header class="bg-white border-b border-stone-200 sticky top-0 z-50 shadow-sm safe-top">
        <div class="max-w-6xl mx-auto px-4 h-14 md:h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 md:w-9 md:h-9 bg-stone-800 rounded flex items-center justify-center text-white font-serif font-bold text-lg md:text-xl">È£ü</div>
                <div>
                    <div class="font-bold text-base md:text-lg leading-tight text-stone-900">Japan 2026</div>
                    <div class="text-[10px] md:text-xs text-stone-500 font-medium hidden md:block">–ì–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –ê–Ω—Ç—Ä–æ–ø–æ–ª–æ–≥–∏—è</div>
                </div>
            </div>
            
            <!-- Desktop Nav (Hidden on Mobile) -->
            <nav class="hidden md:flex gap-2" id="desktop-nav"></nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow w-full max-w-6xl mx-auto px-3 md:px-4 py-4 md:py-8">
        <div id="app-view" class="fade-in"></div>
    </main>

    <!-- Mobile Bottom Navigation (Visible ONLY on Mobile) -->
    <nav class="md:hidden fixed bottom-0 left-0 w-full bg-white border-t border-stone-200 z-50 mobile-safe-bottom shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]">
        <div class="flex justify-around items-center h-16" id="mobile-bottom-nav">
            <!-- Injected by JS -->
        </div>
    </nav>

    <!-- LOGIC & DATA -->
    <script>
        // --- DATA ---
        // (Same data as before)
        const itinerary = [
            { day: "15.04", date: "–°—Ä", city: "–û—Å–∞–∫–∞", title: "–°—Ç–æ–ª–∏—Ü–∞ –î–∞—Å–∏", desc: "–ü—Ä–∏–ª–µ—Ç KIX 11:45. –ö—É–ª—å—Ç—É—Ä–∞ Kuidaore.", food_ref: "osaka" },
            { day: "16.04", date: "–ß—Ç", city: "–û—Å–∞–∫–∞", title: "–ò—Å—Ç–æ—Ä–∏—è –£–¥–æ–Ω–∞", desc: "–†–æ–¥–∏–Ω–∞ –ö–∏—Ü—É–Ω—ç –£–¥–æ–Ω–∞. –£–º–µ–¥–∞.", food_ref: "osaka" },
            { day: "17.04", date: "–ü—Ç", city: "–ö–∏–æ—Ç–æ", title: "–í–æ–¥–∞ –∏ –¢–æ—Ñ—É", desc: "–§–∏–ª–æ—Å–æ—Ñ–∏—è '–°–∏–º–∞—Ü—É'. –û–±–∞–Ω–∑–∞–π.", food_ref: "kyoto" },
            { day: "18.04", date: "–°–±", city: "–ö–æ–±–µ", title: "–ó–∞–ø–∞–¥–Ω—ã–µ –í–ª–∏—è–Ω–∏—è", desc: "–ö–∞—Ñ–µ –≤ —Ü–µ—Ä–∫–≤–∏. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –º—è—Å—É.", food_ref: "kobe" },
            { day: "19.04", date: "–í—Å", city: "–û–Ω–æ–º–∏—Ç–∏", title: "–ü–æ—Ä—Ç–æ–≤–∞—è –ù–æ—Å—Ç–∞–ª—å–≥–∏—è", desc: "‚ö° –°—Ç–∞—Ä—Ç JR Pass. –†–∞–º–µ–Ω —Å –∂–∏—Ä–æ–º.", food_ref: "onomichi" },
            { day: "20.04", date: "–ü–Ω", city: "–ò–º–∞–±–∞—Ä–∏", title: "–°–∫–æ—Ä–æ—Å—Ç—å –∏ –ñ–µ–ª–µ–∑–æ", desc: "–ö—É—Ä–∏—Ü–∞ –Ω–∞ —É—Ç—é–≥–µ. –ë-–ì—É—Ä–º—ç.", food_ref: "imabari" },
            { day: "21.04", date: "–í—Ç", city: "–•–∏—Ä–æ—Å–∏–º–∞", title: "–°–ª–æ–∏ –í–∫—É—Å–∞", desc: "–ú—É–∑–µ–π –ú–∏—Ä–∞. –û–∫–æ–Ω–æ–º–∏—è–∫–∏.", food_ref: "hiroshima" },
            { day: "22.04", date: "–°—Ä", city: "–ú–∏—è–¥–∑–∏–º–∞", title: "–û—Å—Ç—Ä–æ–≤ –ë–æ–≥–æ–≤", desc: "–ü–∞—Ä–æ–º. –£–≥–æ—Ä—å –ê–Ω–∞–≥–æ. –†—ë–∫–∞–Ω.", food_ref: "miyajima" },
            { day: "23.04", date: "–ß—Ç", city: "–°–∏–º–æ–Ω–æ—Å–µ–∫–∏", title: "–ò—Å—Ç–æ—Ä–∏—è –§—É–≥—É", desc: "–ü–µ—Ä–µ–µ–∑–¥. –°–æ–±–∞ –Ω–∞ —á–µ—Ä–µ–ø–∏—Ü–µ.", food_ref: "shimonoseki" },
            { day: "24.04", date: "–ü—Ç", city: "–û—Å–∞–∫–∞", title: "–í–æ–∑–≤—Ä–∞—Ç", desc: "–†—ã–Ω–æ–∫ –ö–∞—Ä–∞—Ç–æ. Shinkansen.", food_ref: "shimonoseki" },
            { day: "25.04", date: "–°–±", city: "–û—Å–∞–∫–∞", title: "–®–æ–ø–∏–Ω–≥ I", desc: "–§–∏–Ω–∞–ª—å–Ω—ã–π —à–æ–ø–∏–Ω–≥.", food_ref: "osaka" },
            { day: "26.04", date: "–í—Å", city: "–û—Å–∞–∫–∞", title: "–®–æ–ø–∏–Ω–≥ II", desc: "–°—É–≤–µ–Ω–∏—Ä—ã. –£–ø–∞–∫–æ–≤–∫–∞.", food_ref: "osaka" },
            { day: "27.04", date: "–ü–Ω", city: "–í—ã–ª–µ—Ç", title: "–î–æ–º–æ–π", desc: "–ü—Ä–æ—â–∞–Ω–∏–µ —Å –Ø–ø–æ–Ω–∏–µ–π.", food_ref: "osaka" }
        ];

        const foodIntel = [
            {
                id: "osaka",
                city: "–û—Å–∞–∫–∞",
                tagline: "–ö—É–ª—å—Ç—É—Ä–∞ 'Kuidaore'",
                desc: "–û—Å–∞–∫–∞ ‚Äî —ç—Ç–æ –∫—É–ª—å—Ç—É—Ä–∞ –±—É–ª—å–æ–Ω–∞ (–¥–∞—Å–∏) –∏–∑ –∫–æ–º–±—É.",
                places: [
                    { name: "Usamitei Matsubaya", type: "–ò—Å—Ç–æ—Ä–∏—è", badge: "badge-history", dish: "Ojiya Udon", price: "¬•820", why: "–ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è –ö–∏—Ü—É–Ω—ç –£–¥–æ–Ω–∞ (1893).", anthro: "–ü—Ä–∞–≥–º–∞—Ç–∏–∑–º —Ç–æ—Ä–≥–æ–≤—Ü–µ–≤: —Ä–∏—Å –∏ –ª–∞–ø—à–∞ –≤ –æ–¥–Ω–æ–π –º–∏—Å–∫–µ." },
                    { name: "Guenpin Fugu", type: "–¢–µ—Ö–Ω–æ", badge: "badge-tech", dish: "Tecchiri (–ù–∞–±—ç)", price: "¬•5,000", why: "–í—ã–¥–µ—Ä–∂–∞–Ω–Ω–∞—è —Ñ—É–≥—É.", anthro: "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è 'aging' —É—Å–∏–ª–∏–≤–∞–µ—Ç —É–º–∞–º–∏." },
                    { name: "Takoyaki Wanaka", type: "–°—Ç—Ä–∏—Ç", badge: "badge-local", dish: "–¢–∞–∫–æ—è–∫–∏", price: "¬•600", why: "–≠—Ç–∞–ª–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–æ.", anthro: "–ú—è–≥–∫–∏–µ –≤–Ω—É—Ç—Ä–∏ ‚Äî –Ω–∞—Å–ª–µ–¥–∏–µ –∫—É–ª—å—Ç—É—Ä—ã —Å—É–ø–æ–≤." }
                ]
            },
            {
                id: "kyoto",
                city: "–ö–∏–æ—Ç–æ",
                tagline: "–§–∏–ª–æ—Å–æ—Ñ–∏—è '–°–∏–º–∞—Ü—É'",
                desc: "–ö—É—Ö–Ω—è –º—è–≥–∫–æ–π –≤–æ–¥—ã –∏ –±—É–¥–¥–∏–π—Å–∫–∏—Ö —Ç—Ä–∞–¥–∏—Ü–∏–π.",
                places: [
                    { name: "Miyako Yasai Kamo", type: "–û–±–∞–Ω–∑–∞–π", badge: "badge-local", dish: "–û–≤–æ—â–Ω–æ–π –±—É—Ñ–µ—Ç", price: "¬•1,100", why: "–î–æ—Å—Ç—É–ø –∫ Kyo-yasai.", anthro: "–í—ã—Å–æ–∫–∞—è –¥–æ–º–∞—à–Ω—è—è –∫—É—Ö–Ω—è. –í–∫—É—Å –æ–≤–æ—â–µ–π –±–µ–∑ —Å–ø–µ—Ü–∏–π." },
                    { name: "Nanzenji Junsei", type: "–Æ–¥–æ—Ñ—É", badge: "badge-history", dish: "–ì–æ—Ä—è—á–∏–π —Ç–æ—Ñ—É", price: "¬•3,500", why: "–û–ø—ã—Ç –¥–∑–µ–Ω-–º–æ–Ω–∞—Ö–æ–≤.", anthro: "–¢–æ—Ñ—É –ø—Ä–æ—Å—Ç–æ –≥—Ä–µ–µ—Ç—Å—è –≤ –≤–æ–¥–µ —Å –∫–æ–º–±—É." }
                ]
            },
            {
                id: "kobe",
                city: "–ö–æ–±–µ",
                tagline: "–ü–æ—Ä—Ç–æ–≤—ã–π –§—å—é–∂–Ω",
                desc: "–û—Ç–∫—Ä—ã—Ç—ã–π –ø–æ—Ä—Ç: —Ö–ª–µ–±, –∫–æ—Ñ–µ –∏ –π–æ—à–æ–∫—É.",
                places: [
                    { name: "Freundlieb", type: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞", badge: "badge-history", dish: "Roast Beef Sandwich", price: "¬•1,800", why: "–ö–∞—Ñ–µ –≤ —Ü–µ—Ä–∫–≤–∏.", anthro: "–ü–∞–º—è—Ç–Ω–∏–∫ –Ω–µ–º–µ—Ü–∫–æ–º—É –≤–ª–∏—è–Ω–∏—é –Ω–∞ —Ö–ª–µ–± –Ø–ø–æ–Ω–∏–∏." },
                    { name: "Mokkosu", type: "Soul Food", badge: "badge-local", dish: "–¢–æ–Ω–∫–æ—Ü—É-–°—ë—é", price: "¬•1,000", why: "–í—ã–±–æ—Ä –º–µ—Å—Ç–Ω—ã—Ö.", anthro: "–ì–æ—Ä–∞ —Å–≤–∏–Ω–∏–Ω—ã. –ï–¥—è—Ç —Å –º–∞—Ä–∏–Ω–æ–≤–∞–Ω–Ω—ã–º –¥–∞–π–∫–æ–Ω–æ–º." }
                ]
            },
            {
                id: "onomichi",
                city: "–û–Ω–æ–º–∏—Ç–∏",
                tagline: "–ï–¥–∞ –¥–æ–∫–µ—Ä–æ–≤",
                desc: "–†–∞–º–µ–Ω —Å –∂–∏—Ä–æ–º –¥–ª—è —ç–Ω–µ—Ä–≥–∏–∏ —Ä–∞–±–æ—á–∏—Ö.",
                places: [
                    { name: "Ichibankan", type: "–†–∞–º–µ–Ω", badge: "badge-local", dish: "Kakuni Ramen", price: "¬•1,200", why: "–≠–≤–æ–ª—é—Ü–∏—è –∫–ª–∞—Å—Å–∏–∫–∏.", anthro: "–ë—É–ª—å–æ–Ω –∏–∑ —Å–∞—Ä–¥–∏–Ω + –æ–≥—Ä–æ–º–Ω—ã–π –∫—É—Å–æ–∫ —Å–≤–∏–Ω–∏–Ω—ã." },
                    { name: "Oyatsu to Yamaneko", type: "–î–µ—Å–µ—Ä—Ç", badge: "badge-sweet", dish: "–ü—É–¥–∏–Ω–≥", price: "¬•450", why: "–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ—Å–µ—Ä—Ç–∞.", anthro: "–õ–∏–º–æ–Ω–Ω—ã–π —Å–∏—Ä–æ–ø –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –ø—É–¥–∏–Ω–≥ –≤ —á–∏–∑–∫–µ–π–∫." }
                ]
            },
            {
                id: "imabari",
                city: "–ò–º–∞–±–∞—Ä–∏",
                tagline: "–ù–µ—Ç–µ—Ä–ø–µ–ª–∏–≤–æ—Å—Ç—å",
                desc: "–ì–æ—Ç–æ–≤–∫–∞ –Ω–∞ '—É—Ç—é–≥–µ' —Ä–∞–¥–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏.",
                places: [
                    { name: "Yakitori Toribayashi", type: "Teppan", badge: "badge-tech", dish: "Kawa (–ö–æ–∂–∞)", price: "¬•500", why: "–ñ–∞—Ä–∫–∞ –ø—Ä–µ—Å—Å–æ–º.", anthro: "–ë–µ–∑ —à–∞–º–ø—É—Ä–æ–≤, –Ω–∞ –∂–µ–ª–µ–∑–Ω–æ–π –ø–ª–∏—Ç–µ. –ë—ã—Å—Ç—Ä–æ –∏ —Ö—Ä—É—Å—Ç—è—â–µ." },
                    { name: "Hakurakuten", type: "B-Gourmet", badge: "badge-local", dish: "–Ø–∫–∏–±—É—Ç–∞ –¢–∞–º–∞–≥–æ", price: "¬•900", why: "–£–≥–ª–µ–≤–æ–¥–Ω–∞—è –±–æ–º–±–∞.", anthro: "–†–∏—Å + –°–≤–∏–Ω–∏–Ω–∞ + –Ø–π—Ü–∞. –°–º–µ—à–∏–≤–∞—Ç—å –ª–æ–∂–∫–æ–π." }
                ]
            },
            {
                id: "hiroshima",
                city: "–•–∏—Ä–æ—Å–∏–º–∞",
                tagline: "–°–ª–æ–∏",
                desc: "–°–ª–æ–∏ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤, –∞ –Ω–µ —Å–º–µ—à–∏–≤–∞–Ω–∏–µ.",
                places: [
                    { name: "Hassho", type: "–ö—É–ª—å—Ç", badge: "badge-local", dish: "–û–∫–æ–Ω–æ–º–∏—è–∫–∏", price: "¬•1,300", why: "–î–≤–æ–π–Ω–æ–π –∂–µ–ª—Ç–æ–∫.", anthro: "–ì–æ—Ç–æ–≤—è—Ç 20 –º–∏–Ω, —á—Ç–æ–±—ã –ª–∞–ø—à–∞ —Å—Ç–∞–ª–∞ —Ö—Ä—É—Å—Ç—è—â–µ–π." },
                    { name: "Bakudan-ya", type: "–û—Å—Ç—Ä–æ—Ç–∞", badge: "badge-tech", dish: "–¶—É–∫—ç–º—ç–Ω", price: "¬•1,100", why: "–•–æ–ª–æ–¥–Ω–∞—è –∏ –æ—Å—Ç—Ä–∞—è.", anthro: "–û–≤–æ—â–∏ –±–∞–ª–∞–Ω—Å–∏—Ä—É—é—Ç –ø–µ—Ä–µ—á–Ω—ã–π —É–¥–∞—Ä." }
                ]
            },
            {
                id: "miyajima",
                city: "–ú–∏—è–¥–∑–∏–º–∞",
                tagline: "–î–∞—Ä—ã –º–æ—Ä—è",
                desc: "–ï–¥–∞ –∫–∞–∫ —á–∞—Å—Ç—å –ø–∞–ª–æ–º–Ω–∏—á–µ—Å—Ç–≤–∞.",
                places: [
                    { name: "Anagomeshi Ueno", type: "–ú–∏—à–ª–µ–Ω", badge: "badge-history", dish: "–ê–Ω–∞–≥–æ-–º–µ—à–∏", price: "¬•2,500", why: "–ú–æ—Ä—Å–∫–æ–π —É–≥–æ—Ä—å.", anthro: "–ú–µ–Ω–µ–µ –∂–∏—Ä–Ω—ã–π, —á–µ–º —Ä–µ—á–Ω–æ–π. –ë–ª—é–¥–æ —Å 1901 –≥–æ–¥–∞." },
                    { name: "Momijido", type: "–°–Ω—ç–∫", badge: "badge-sweet", dish: "Agemomiji", price: "¬•200", why: "–ñ–∞—Ä–µ–Ω—ã–π –¥–µ—Å–µ—Ä—Ç.", anthro: "–ü–∏—Ä–æ–∂–æ–∫ –≤ –∫–ª—è—Ä–µ –≤–æ —Ñ—Ä–∏—Ç—é—Ä–µ. –ù–æ–≤—ã–π –≤–∫—É—Å —Å—Ç–∞—Ä–æ–π —Ñ–æ—Ä–º—ã." }
                ]
            },
            {
                id: "shimonoseki",
                city: "–°–∏–º–æ–Ω–æ—Å–µ–∫–∏",
                tagline: "–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å",
                desc: "–°—Ç–æ–ª–∏—Ü–∞ –§—É–≥—É –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–æ–≥–æ–≤–æ—Ä—ã.",
                places: [
                    { name: "Kawara Soba Takase", type: "–õ–µ–≥–µ–Ω–¥–∞", badge: "badge-history", dish: "Kawara Soba", price: "¬•1,300", why: "–°–æ–±–∞ –Ω–∞ —á–µ—Ä–µ–ø–∏—Ü–µ.", anthro: "–í–¥–æ—Ö–Ω–æ–≤–ª–µ–Ω–æ —Å–æ–ª–¥–∞—Ç–∞–º–∏ –≤–æ–π–Ω—ã 1877 –≥–æ–¥–∞." },
                    { name: "Shunpanro", type: "–õ—é–∫—Å", badge: "badge-history", dish: "Fugu Kaiseki", price: "¬•6,000+", why: "–í—ã—Å–æ–∫–∞—è –∫—É—Ö–Ω—è.", anthro: "–ù–∞—Ä–µ–∑–∫–∞ '—Ö—Ä–∏–∑–∞–Ω—Ç–µ–º–∞' ‚Äî –≤–µ—Ä—à–∏–Ω–∞ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞." }
                ]
            }
        ];

        const logistics = [
            { title: "JR Pass Sanyo-San'in", desc: "–≠–∫–æ–Ω–æ–º–∏—è > $100. –ê–∫—Ç–∏–≤–∞—Ü–∏—è 19.04. –ü–æ–∫—Ä—ã–≤–∞–µ—Ç –û—Å–∞–∫–∞-–•–∏—Ä–æ—Å–∏–º–∞-–•–∞–∫–∞—Ç–∞.", icon: "üé´" },
            { title: "Yamato Transport", desc: "19.04 –û—Å–∞–∫–∞ -> –•–∏—Ä–æ—Å–∏–º–∞. 23.04 –•–∏—Ä–æ—Å–∏–º–∞ -> –û—Å–∞–∫–∞.", icon: "üöö" },
            { title: "–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ", desc: "–†—ë–∫–∞–Ω (–ú–∏—è–¥–∑–∏–º–∞) –∏ Hassho (–•–∏—Ä–æ—Å–∏–º–∞) —Ç—Ä–µ–±—É—é—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.", icon: "üìÖ" }
        ];

        // --- APP STATE ---
        let view = 'itinerary';
        let selectedCityId = 'osaka';

        // --- RENDERERS ---
        function init() {
            renderDesktopNav();
            renderMobileNav();
            renderView();
        }

        // DESKTOP NAV (Top Bar)
        function renderDesktopNav() {
            const tabs = [
                { id: 'itinerary', label: '–ú–∞—Ä—à—Ä—É—Ç' },
                { id: 'food', label: '–ì–∏–¥ –ø–æ –ï–¥–µ' },
                { id: 'logistics', label: '–õ–æ–≥–∏—Å—Ç–∏–∫–∞' }
            ];
            const html = tabs.map(t => `
                <button onclick="switchView('${t.id}')" class="px-4 py-2 text-sm font-medium rounded-md transition-colors ${view === t.id ? 'bg-stone-100 text-red-800' : 'text-stone-600 hover:bg-stone-50'}">
                    ${t.label}
                </button>
            `).join('');
            document.getElementById('desktop-nav').innerHTML = html;
        }

        // MOBILE NAV (Bottom Bar)
        function renderMobileNav() {
            const tabs = [
                { id: 'itinerary', label: '–ú–∞—Ä—à—Ä—É—Ç', icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />' },
                { id: 'food', label: '–ï–¥–∞', icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />' },
                { id: 'logistics', label: '–ò–Ω—Ñ–æ', icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />' }
            ];
            
            const html = tabs.map(t => `
                <button onclick="switchView('${t.id}')" class="flex flex-col items-center justify-center w-full h-full space-y-1 ${view === t.id ? 'text-red-700' : 'text-stone-400'}">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">${t.icon}</svg>
                    <span class="text-[10px] font-medium">${t.label}</span>
                </button>
            `).join('');
            document.getElementById('mobile-bottom-nav').innerHTML = html;
        }

        function switchView(newView) {
            view = newView;
            renderDesktopNav();
            renderMobileNav();
            renderView();
            window.scrollTo(0,0);
        }

        function renderView() {
            const container = document.getElementById('app-view');
            container.innerHTML = '';
            
            if (view === 'itinerary') renderItinerary(container);
            if (view === 'food') renderFood(container);
            if (view === 'logistics') renderLogistics(container);
        }

        // --- VIEWS ---

        function renderItinerary(container) {
            let html = `<div class="space-y-4">`;
            
            itinerary.forEach((item, index) => {
                const isSpecial = item.title.includes("JR Pass");
                html += `
                    <div class="flex gap-3 relative">
                        <!-- Timeline Line -->
                        <div class="absolute left-[18px] top-8 bottom-[-16px] w-[2px] bg-stone-200 z-0 ${index === itinerary.length - 1 ? 'hidden' : ''}"></div>
                        
                        <!-- Date Bubble -->
                        <div class="flex-shrink-0 z-10 text-center">
                            <div class="w-10 h-10 rounded-full bg-white border-2 ${isSpecial ? 'border-yellow-400' : 'border-stone-300'} flex items-center justify-center shadow-sm">
                                <div class="text-[10px] font-bold text-stone-600 leading-none">
                                    <div class="uppercase text-[8px] text-stone-400">${item.date}</div>
                                    ${item.day.split('.')[0]}
                                </div>
                            </div>
                        </div>

                        <!-- Card -->
                        <div class="flex-grow bg-white rounded-lg border border-stone-200 p-3 md:p-4 shadow-sm active:scale-[0.99] transition-transform">
                            <div class="flex justify-between items-start mb-1">
                                <h3 class="font-bold text-stone-900 text-sm md:text-base">${item.title}</h3>
                                <span class="text-[10px] font-bold px-2 py-0.5 rounded bg-stone-100 text-stone-500">${item.city}</span>
                            </div>
                            <p class="text-stone-600 text-xs md:text-sm mb-3 leading-relaxed">${item.desc}</p>
                            
                            <button onclick="jumpToFood('${item.food_ref}')" class="w-full flex items-center justify-between bg-stone-50 border border-stone-100 rounded px-2 py-1.5 hover:bg-red-50 hover:border-red-100 transition-colors">
                                <span class="text-[10px] font-bold text-red-800 flex items-center gap-1">
                                    üçΩÔ∏è –í–∫—É—Å–Ω–æ
                                </span>
                                <span class="text-[10px] text-stone-400">–ü–µ—Ä–µ–π—Ç–∏ &rarr;</span>
                            </button>
                        </div>
                    </div>
                `;
            });
            html += `</div>`;
            container.innerHTML = html;
        }

        function renderFood(container) {
            // Horizontal Scroll for Mobile, Sidebar for Desktop
            let html = `
                <div class="flex flex-col md:flex-row gap-4 md:gap-6">
                    
                    <!-- City Selector (Sticky Top on Mobile) -->
                    <div class="sticky top-14 md:top-20 z-30 bg-[#fcfbf9] pt-2 pb-2 md:pb-0 md:pt-0 md:w-1/4">
                        <!-- Mobile Horizontal Scroll -->
                        <div class="md:hidden flex overflow-x-auto hide-scroll gap-2 pb-1">
                            ${foodIntel.map(city => `
                                <button onclick="selectCity('${city.id}')" 
                                    class="flex-shrink-0 px-4 py-2 rounded-full border text-xs font-bold whitespace-nowrap transition-all
                                    ${selectedCityId === city.id 
                                        ? 'bg-stone-800 text-white border-stone-800 shadow-md' 
                                        : 'bg-white text-stone-600 border-stone-200'}">
                                    ${city.city}
                                </button>
                            `).join('')}
                        </div>

                        <!-- Desktop Vertical List -->
                        <div class="hidden md:flex flex-col gap-2">
                             <h2 class="text-xs font-bold text-stone-400 uppercase tracking-widest mb-2 px-1">–†–µ–≥–∏–æ–Ω—ã</h2>
                            ${foodIntel.map(city => `
                                <button onclick="selectCity('${city.id}')" 
                                    class="text-left px-4 py-3 rounded-lg border transition-all
                                    ${selectedCityId === city.id 
                                        ? 'bg-stone-800 text-white border-stone-800 shadow-md' 
                                        : 'bg-white text-stone-600 border-stone-200 hover:bg-stone-50'}">
                                    <span class="font-bold text-sm">${city.city}</span>
                                </button>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Details Area -->
                    <div class="w-full md:w-3/4">
                        ${renderCityFoodDetails(selectedCityId)}
                    </div>
                </div>
            `;
            container.innerHTML = html;
        }

        function renderCityFoodDetails(id) {
            const city = foodIntel.find(c => c.id === id);
            return `
                <div class="bg-white rounded-xl border border-stone-200 shadow-sm overflow-hidden fade-in pb-4">
                    <!-- Hero Header -->
                    <div class="bg-stone-100 p-4 md:p-6 border-b border-stone-200">
                        <div class="flex items-baseline justify-between">
                            <h2 class="text-2xl md:text-3xl font-serif font-bold text-stone-900">${city.city}</h2>
                            <span class="text-4xl opacity-20">üçú</span>
                        </div>
                        <p class="text-stone-600 font-medium italic text-xs md:text-sm mt-1">"${city.tagline}"</p>
                        <p class="text-stone-500 text-xs mt-2 leading-relaxed hidden md:block">${city.desc}</p>
                    </div>

                    <!-- Cards -->
                    <div class="divide-y divide-stone-100">
                        ${city.places.map(place => `
                            <div class="p-4 md:p-6 active:bg-stone-50 transition-colors">
                                <div class="flex justify-between items-start mb-2">
                                    <div>
                                        <h3 class="font-bold text-base text-stone-900 leading-tight">
                                            ${place.name}
                                        </h3>
                                        <div class="text-xs font-bold text-stone-500 mt-1">${place.dish} <span class="text-stone-300">|</span> <span class="font-mono text-stone-700">${place.price}</span></div>
                                    </div>
                                    <span class="food-badge ${getBadgeStyle(place.badge)} ml-2">${place.type}</span>
                                </div>
                                
                                <div class="mt-2 space-y-2">
                                    <p class="text-stone-800 text-xs leading-relaxed"><strong>Why:</strong> ${place.why}</p>
                                    <div class="bg-stone-50 p-2 rounded text-[11px] text-stone-600 italic border-l-2 border-stone-300">
                                        "${place.anthro}"
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderLogistics(container) {
            container.innerHTML = `
                <div class="space-y-4 max-w-xl mx-auto">
                    ${logistics.map(l => `
                        <div class="bg-white p-4 rounded-xl border border-stone-200 shadow-sm flex gap-4 items-start">
                            <div class="bg-stone-100 w-10 h-10 rounded-full flex items-center justify-center text-xl flex-shrink-0">
                                ${l.icon}
                            </div>
                            <div>
                                <h3 class="font-bold text-stone-900 text-sm md:text-base">${l.title}</h3>
                                <p class="text-stone-600 text-xs md:text-sm mt-1 leading-relaxed">${l.desc}</p>
                            </div>
                        </div>
                    `).join('')}
                    
                    <div class="mt-8 text-center px-4">
                        <p class="text-xs text-stone-400">
                            –°–æ–≤–µ—Ç: –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã,<br>—á—Ç–æ–±—ã –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –æ—Ñ–ª–∞–π–Ω.
                        </p>
                    </div>
                </div>
            `;
        }

        // --- HELPERS ---
        function selectCity(id) {
            selectedCityId = id;
            renderView(); // Re-render to update UI
        }

        function jumpToFood(cityId) {
            selectedCityId = cityId;
            switchView('food');
        }

        function getBadgeStyle(badgeClass) {
            return badgeClass;
        }

        // --- INIT ---
        init();

    </script>
</body>
</html>
